generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model migrations {
  id          Int       @id
  name        String    @unique @db.VarChar(100)
  hash        String    @db.VarChar(40)
  executed_at DateTime? @default(now()) @db.Timestamp(6)
}

model TosApproval {
  id          Int      @id @default(autoincrement())
  address     String   @db.VarChar(66)
  doc_version String   @db.VarChar
  sign_date   DateTime @db.Timestamp(6)

  @@unique([address, doc_version], name: "tos_approval_unique_signature", map: "tos_approval_unique_signature")
  @@map("tos_approval")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model Vault {
  vault_id      Int
  type          VaultType
  owner_address String    @db.Char(42)
  chain_id      Int?

  @@unique([vault_id, chain_id], name: "vault_vault_id_chain_id_unique_constraint", map: "vault_vault_id_chain_id_unique_constraint")
  @@map("vault")
  @@ignore
}

model User {
  address                    String        @unique
  createdAt                  DateTime      @default(now())
  user_that_referred_address String?
  total_amount               String
  accepted                   Boolean
  user_that_referred         User?         @relation("UserToUser", fields: [user_that_referred_address], references: [address])
  referred_users             User[]        @relation("UserToUser")
  weekly_claims              WeeklyClaim[]

  @@map("user")
}

model WeeklyClaim {
  id           Int      @id @default(autoincrement())
  week_number  Int
  user_address String
  proof        String[]
  amount       String
  claimant     User     @relation(fields: [user_address], references: [address])

  @@unique([week_number, user_address], name: "week_number_userAddress_unique_id")
  @@map("weekly_claim")
}

model MerkleTree {
  week_number Int    @unique
  tree_root   String

  @@map("merkle_tree")
}

enum VaultType {
  borrow
  multiply

  @@map("vault_type")
}
